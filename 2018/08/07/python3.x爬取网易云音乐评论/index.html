<!DOCTYPE html>
<html lang=zh>
<head>
    <meta charset="utf-8">
    
    <title>利用python爬取网易云音乐评论，并把数据存入mysql | sergiojune | 梦开始的地方</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="在简单学习了python爬虫后，又想继续折腾，进而找到了这个网易云音乐，因为本人平时就是用它听的歌，也喜欢看歌里的评论，所以就爬网易云音乐评论吧，那么开始吧！正式进入主题首先还是去找目标网页并开始分析网页结构，如下上面的三个箭头都是所要找的数据，分别是评论用户，评论和点赞数，都可以用正则表达式找出来，接下来继续找怎样找到下一页的数据，还是用开发者工具，但是当点击下一页的时候，网页的url没有变，说">
<meta name="keywords" content="爬虫,requestst">
<meta property="og:type" content="article">
<meta property="og:title" content="利用python爬取网易云音乐评论，并把数据存入mysql">
<meta property="og:url" content="http://sergiojune.com/2018/08/07/python3.x爬取网易云音乐评论/index.html">
<meta property="og:site_name" content="sergiojune | 梦开始的地方">
<meta property="og:description" content="在简单学习了python爬虫后，又想继续折腾，进而找到了这个网易云音乐，因为本人平时就是用它听的歌，也喜欢看歌里的评论，所以就爬网易云音乐评论吧，那么开始吧！正式进入主题首先还是去找目标网页并开始分析网页结构，如下上面的三个箭头都是所要找的数据，分别是评论用户，评论和点赞数，都可以用正则表达式找出来，接下来继续找怎样找到下一页的数据，还是用开发者工具，但是当点击下一页的时候，网页的url没有变，说">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802044488.png">
<meta property="og:image" content="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802044234.png">
<meta property="og:image" content="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802041841.png">
<meta property="og:image" content="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802043912.png">
<meta property="og:image" content="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802045600.png">
<meta property="og:image" content="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802049865.png">
<meta property="og:image" content="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802041977.png">
<meta property="og:image" content="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802041200.png">
<meta property="og:image" content="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802041185.png">
<meta property="og:image" content="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802042238.png">
<meta property="og:image" content="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802041943.png">
<meta property="og:image" content="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802043715.png">
<meta property="og:image" content="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802041150.png">
<meta property="og:image" content="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802042410.png">
<meta property="og:image" content="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802046744.png">
<meta property="og:image" content="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802044023.png">
<meta property="og:image" content="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802057877.png">
<meta property="og:image" content="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802058447.png">
<meta property="og:image" content="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802056847.png">
<meta property="og:image" content="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802051937.png">
<meta property="og:image" content="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802052702.png">
<meta property="og:image" content="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802056776.png">
<meta property="og:image" content="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802049613.png">
<meta property="og:image" content="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802052783.png">
<meta property="og:image" content="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802057884.png">
<meta property="og:image" content="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802059926.png">
<meta property="og:image" content="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802051477.png">
<meta property="og:image" content="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802058622.png">
<meta property="og:image" content="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802052656.png">
<meta property="og:image" content="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802055375.png">
<meta property="og:image" content="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802053659.png">
<meta property="og:image" content="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802055481.png">
<meta property="og:image" content="https://mmbiz.qlogo.cn/mmbiz/QKDxrVYehicdAibIVUpquF6TQUwXFg6dYCrLBEiasLaVyObib9LjK08qQ7IzkYKROO93uxoEnMSl8zRCWiaY7JwgZWg/0?wx_fmt=jpeg">
<meta property="og:image" content="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802053253.png">
<meta property="og:updated_time" content="2018-08-06T08:53:50.853Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="利用python爬取网易云音乐评论，并把数据存入mysql">
<meta name="twitter:description" content="在简单学习了python爬虫后，又想继续折腾，进而找到了这个网易云音乐，因为本人平时就是用它听的歌，也喜欢看歌里的评论，所以就爬网易云音乐评论吧，那么开始吧！正式进入主题首先还是去找目标网页并开始分析网页结构，如下上面的三个箭头都是所要找的数据，分别是评论用户，评论和点赞数，都可以用正则表达式找出来，接下来继续找怎样找到下一页的数据，还是用开发者工具，但是当点击下一页的时候，网页的url没有变，说">
<meta name="twitter:image" content="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802044488.png">
    

    
        <link rel="alternate" href="/" title="sergiojune | 梦开始的地方" type="application/atom+xml" />
    

    

    <link rel="stylesheet" href="/libs/font-awesome5/css/fontawesome.min.css">
    <link rel="stylesheet" href="/libs/font-awesome5/css/fa-brands.min.css">
    <link rel="stylesheet" href="/libs/font-awesome5/css/fa-solid.min.css">
    <link rel="stylesheet" href="/libs/open-sans/styles.css">
    <link rel="stylesheet" href="/libs/source-code-pro/styles.css">

    <link rel="stylesheet" href="/css/style.css">

    <script src="/libs/jquery/2.1.3/jquery.min.js"></script>
    
    
        <link rel="stylesheet" href="/libs/lightgallery/css/lightgallery.min.css">
    
    
        <link rel="stylesheet" href="/libs/justified-gallery/justifiedGallery.min.css">
    
    
    
    


</head>

<body>
    <div id="container">
        <header id="header">
    <div id="header-main" class="header-inner">
        <div class="outer">
            <a href="/" id="logo">
                <i class="logo"></i>
                <span class="site-title">sergiojune | 梦开始的地方</span>
            </a>
            <nav id="main-nav">
                
                    <a class="main-nav-link" href="/.">Home</a>
                
                    <a class="main-nav-link" href="/归档">Archives</a>
                
                    <a class="main-nav-link" href="/分类">Categories</a>
                
                    <a class="main-nav-link" href="/标签">Tags</a>
                
                    <a class="main-nav-link" href="/关于">About</a>
                
            </nav>
            
                
                <nav id="sub-nav">
                    <div class="profile" id="profile-nav">
                        <a id="profile-anchor" href="javascript:;">
                            <img class="avatar" src="/css/images/avatar.jpg" />
                            <i class="fas fa-caret-down"></i>
                        </a>
                    </div>
                </nav>
            
            <div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="搜索" />
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="想要查找什么..." />
            <span class="ins-close ins-selectable"><i class="fas fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(未命名)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>

</div>
        </div>
    </div>
    <div id="main-nav-mobile" class="header-sub header-inner">
        <table class="menu outer">
            <tr>
                
                    <td><a class="main-nav-link" href="/.">Home</a></td>
                
                    <td><a class="main-nav-link" href="/归档">Archives</a></td>
                
                    <td><a class="main-nav-link" href="/分类">Categories</a></td>
                
                    <td><a class="main-nav-link" href="/标签">Tags</a></td>
                
                    <td><a class="main-nav-link" href="/关于">About</a></td>
                
                <td>
                    
    <div class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="搜索" />
    </div>

                </td>
            </tr>
        </table>
    </div>
</header>

        <div class="outer">
            
                

<aside id="profile" class="profile-fixed">
    <div class="inner profile-inner">
        <div class="base-info profile-block">
            <img id="avatar" src="/css/images/avatar.jpg" />
            <h2 id="name">sergiojune</h2>
            <h3 id="title">我本微末凡尘，却也心向天空</h3>
            <span id="location"><i class="fas fa-map-marker-alt" style="padding-right: 5px"></i>GuangZhou, China</span>
            <a id="follow" target="_blank" href="https://github.com/SergioJune">关注我</a>
        </div>
        <div class="article-info profile-block">
            <div class="article-info-block">
                26
                <span>文章</span>
            </div>
            <div class="article-info-block">
                10
                <span>标签</span>
            </div>
        </div>
        
        <div class="profile-block social-links">
            <table>
                <tr>
                    
                    
                    <td>
                        <a href="https://github.com/SergioJune" target="_blank" title="github" class=tooltip>
                            <i class="fab fa-github"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="https://www.zhihu.com/people/ying-xing-69-8/activities" target="_blank" title="zhihu" class=tooltip>
                            <i class="fab fa-zhihu"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="https://juejin.im/user/5a9fc4506fb9a028d140a761" target="_blank" title="jvejin" class=tooltip>
                            <i class="fab fa-jvejin"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="/" target="_blank" title="dribbble" class=tooltip>
                            <i class="fab fa-dribbble"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="/" target="_blank" title="rss" class=tooltip>
                            <i class="fab fa-rss"></i>
                        </a>
                    </td>
                    
                </tr>
            </table>
        </div>
        
    </div>
</aside>

            
            <section id="main"><article id="post-python3.x爬取网易云音乐评论" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 class="article-title" itemprop="name">
            利用python爬取网易云音乐评论，并把数据存入mysql
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fas fa-calendar-alt"></i>
        <a href="/2018/08/07/python3.x爬取网易云音乐评论/">
            <time datetime="2018-08-07T00:43:42.113Z" itemprop="datePublished">2018-08-07</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fas fa-folder"></i>
        <a class="article-category-link" href="/categories/python/">python</a>
    </div>

                        
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/tags/requestst/">requestst</a>, <a class="tag-link" href="/tags/爬虫/">爬虫</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <section class="96edit" label="Powered by bj.96weixin.com" style="font-size:16px;"><section class="editor"><section editor="bj.96weixin.com" style="margin:0 auto;padding:0;box-sizing:border-box"><section class="yead_bgc wx-bg" style="border-style: solid; -webkit-border-image: url(&quot;https://mmbiz.qpic.cn/mmbiz_png/v4vz52CcB13JzTTXXg3mC439fK28gxRK85c5jJicI6ia4ibEOx5DTicoiciamOZc6hcaLFy9S1AfhJzm8kUAHJnv4jtQ/0&quot;) 15 5 5 fill stretch; color: rgb(51, 51, 51); border-width: 10px 4px 4px; padding: 0px; box-sizing: border-box; background-color: rgb(51, 184, 108);"><section style="width: 100%; font-size: 14px; margin: 0px; line-height: 30px; padding: 0px 5px; box-sizing: border-box;" data-width="100%"><p style="padding:0;margin:0;text-align:justify">在简单学习了python爬虫后，又想继续折腾，进而找到了这个网易云音乐，因为本人平时就是用它听的歌，也喜欢看歌里的评论，所以就爬网易云音乐评论吧，那么开始吧！</p></section></section></section><p><br></p><section class="editor"><section class="editor"><section style="width:100%; text-align:center;" data-width="100%"><section style="display: inline-block; border-width: 5px; border-style: solid; -webkit-border-image: url(&quot;https://mmbiz.qpic.cn/mmbiz_png/uN1LIav7oJ94OAxhxMZuj75SnON56cqmO9jNia9DuXHjVlkiasaiaJIbrtDbmTq6hK2es1BeyapTqz6viaZhgxkxZQ/0?wx_fmt=png&quot;) 5 fill; box-sizing: border-box;"><section style="padding: 2px 10px; text-align: center; color: rgb(225, 201, 255); font-size: 16px; box-sizing: border-box;"><strong>正式进入主题</strong></section></section></section></section></section><p><br></p><p>首先还是去找目标网页并开始分析网页结构，如下</p></section><p><br></p><p><img src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802044488.png" title="1802044488.png" alt=""></p><p><br></p><p>上面的三个箭头都是所要找的数据，分别是评论用户，评论和点赞数，都可以用正则表达式找出来，接下来继续找怎样找到下一页的数据，还是用开发者工具，但是当点击下一页的时候，网页的url没有变，说明网页是动态加载，所以就不能在当前网页找数据了，应该在他的<strong>xhr</strong>文件里找，所以点入<strong>network</strong>看看，然后也点击下一页一看，果然有想要的</p><p><br></p><p><img src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802044234.png" title="1802044234.png" alt=""></p><p>看到这里，就兴奋地去敲代码了</p><p><br></p><p><img src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802041841.png" title="1802041841.png" alt=""></p><p><br></p><p>一点击运行，结果什么东西都没有，但是他的状态码是200，明显请求成功啊，却没有东西返回，再去network仔细看看这个网页，看到他是个post请求，也看到了需要post两个参数params和ensSecKey</p><p><br></p><p><img src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802043912.png" title="1802043912.png" alt="">一看到这个，密密麻麻的数字和字母，就猜应该是被加密了，不过可以复制下来看看有没有用。接下来看下他的Response，咦，这是个json，不是html结构的，所以需要用到Json库来进行解析</p><p><br></p><p><img src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802045600.png" title="1802045600.png" alt=""></p><p>现在开始敲代码吧，先把上面的两个参数复制过来看看。</p><p><br></p><p><img src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802049865.png" title="1802049865.png" alt=""></p><p>现在把每条评论的评论用户和点赞数和评论获取出来</p><p><br></p><p><img src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802041977.png" title="1802041977.png" alt=""></p><p>可以看到，利用json.loads()方法把数据转成python格式里的字典后就可以把想要的数据取出来了，但是，下一页怎样取？总不能每次都复制粘贴那两个参数吧？那唯一的方法就是不爬了。。怎么可能？我的继续，那我就要进行破解这两个参数了，那好继续看<strong>network，</strong>因为要加密，肯定要用js进行加密的</p><p><br></p><p><img src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802041200.png" title="1802041200.png" alt=""></p><p>看到刚才那个网站的发起者core.js,,然后把它文件下载下来慢慢研究</p><p><br></p><p><img src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802041185.png" title="1802041185.png" alt=""></p><p>保存后在经过美化，然后进行查找那个encSecKey参数（ps:JSj’e’tong’yang’de美化网址为<a href="http://www.css88.com/tool/js_beautify/），然后找到这个" _src="http://www.css88.com/tool/js_beautify/），然后找到这个" target="_blank" rel="noopener">http://www.css88.com/tool/js_beautify/），然后找到这个</a></p><p><img src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802042238.png" title="1802042238.png" alt=""></p><p>看到window.asrsea()方法有四个参数，先不去管这个函数，先看看他的四个参数是什什，这里没必要去研究那四个参数怎样来的，只需要知道他是什么，那么我们可以加点代码上去让他显示出来，从而利用fiddler来进行调试</p><p>加入代码如下<img src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802041943.png" title="1802041943.png" alt=""></p><p>可以分别获取上面的每一个参数，也把那个params获取看看，然后在fiddler上操作如下</p><p><br></p><p><img src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802043715.png" title="1802043715.png" alt=""><img src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802041150.png" title="1802041150.png" alt=""></p><p>完成上面的设置后刷新网页就可以在console上面找到参数信息，如果没有的话这是因为你之前浏览该网页的时候它被缓存了下来，所以要清除缓存文件（在清除浏览器记录里面有）</p><p><br></p><p><img src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802042410.png" title="1802042410.png" alt=""></p><p>那个rid有本歌曲的id，明显是与评论有关的，我试着连翻几页后，发现那个offset就是评论偏移数，offset就是(页数-1)<em>20，total在第一页是true，在其他页是false<br></em></p><p><img src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802046744.png" title="1802046744.png" alt="">同样的方法也得到第二个参数为：010001</p><p>第三个参数为：00e0b509f6259df8642dbc35662901477df22677ec152b5ff68ace615bb7b725152b3ab17a876aea8a5aa76d2e417629ec4ee341f56135fccf695280104e0312ecbda92557c93870114af6c9d05c4f7f0c3685b7a46bee255932575cce10b424d813cfe4875d3e82047b97ddef52741d546b8e289dc6935b3ece0462db0a22b8e7</p><p>第四个参数为：0CoJUm6Qyw8W8jud</p><p><br></p><p>接下来就要看window.asrsea()方法是什么操作的了，还是通过查找js文件可以看到这个<img src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802044023.png" title="1802044023.png" alt=""></p><p><br></p><p>通过研究i是随机获取十六个字符而b函数是<strong>AES加密</strong>，其中偏移量为<strong>0102030405060708</strong>，模式为<strong>CBC</strong>，看回d函数，其中<strong>params连续两次加密，第一次加密时，<span style="line-height: 25.6px; white-space: pre-wrap;">文本为第一个参数。密钥为第四个参数，第二次加密时文本为第一次加密的值，密钥为随机数a。而encS<span style="line-height: 25.6px; white-space: pre-wrap;">ec</span>key是一个RSA加密，他的公钥是第二个参数，模式是第三个参数，文本为那个随机字符串a</span></strong></p><p><br></p><p>终于分析完了，接着开始敲代码</p><p><br></p><p>先来个获取第一页评论的代码</p><p>这是获取两个参数的类<br></p><p><img src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802057877.png" title="1802057877.png" alt=""><img src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802058447.png" title="1802058447.png" alt=""><img src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802056847.png" title="1802056847.png" alt=""></p><p><br></p><p>这是解析网易云音乐和获取评论的类</p><p><img src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802051937.png" title="1802051937.png" alt=""><img src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802052702.png" title="1802052702.png" alt=""><img src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802056776.png" title="1802056776.png" alt=""></p><p><br></p><p>然而一点击运行，直接给我报了个错：<strong>TypeError: can’t concat str to bytes</strong></p><p><img src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802049613.png" title="1802049613.png" alt=""></p><p><br></p><p>原来是因为在第二次加密的时候，那个params是个byte类型，所以把他转成字符串类型就可以了<img src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802052783.png" title="1802052783.png" alt=""></p><p><br></p><p>再次点击运行，结果还是报错了：<strong>json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)</strong></p><p><img src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802057884.png" title="1802057884.png" alt=""></p><p><br></p><p>这个报错因为我的json解析错了，回头调试一看，<strong>网页返回的东西是空的，但他的状态码是200</strong>，这是什么鬼？接着我再试了把那两个参数的值直接复制和前面一样看看，结果运行成功，这就说明我的是加密过程错了，然后我就回去看了几篇，看不出什么错误，上网百度找到了这个知乎文章<strong><a href="https://zhuanlan.zhihu.com/p/32069543" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/32069543</a></strong>，我把她的代码复制过来运行下，结果是可以的，我就继续看看我和她的区别，原来我<strong>在用那个16个随机字符的时候用错了，我在两个参数给了两个不同的，而是需要给共同一个的</strong>，看到这里，我就直接回去改了下，果然运行成功，代码我就不贴出来了，效果如下<img src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802059926.png" title="1802059926.png" alt=""></p><p><br></p><p>接着是获取每一页的评论，而每一页与第一个参数的offset有关，其中的公式为<strong>offse=(页数-1)20</strong>，total在第一页是true，在其他页是false</p><p><img src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802051477.png" title="1802051477.png" alt=""><img src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802058622.png" title="1802058622.png" alt=""><img src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802052656.png" title="1802052656.png" alt=""></p><p><img src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802055375.png" title="1802055375.png" alt="">而写入数据库我用的是我这篇文章的操作</p><div>&nbsp;<a href="http://mp.weixin.qq.com/s/6sQ_ER39P2NtXaPOnGdQNA" target="_blank" rel="noopener">http://mp.weixin.qq.com/s/6sQ_ER39P2NtXaPOnGdQNA</a><br></div><p>，由于篇幅过长，就不贴出来了，感兴趣的可以去看看<br></p><p><br></p><p>接下来点运行就可以了，但是运行到第八页的时候出现了这个异常</p><p><strong>raise errorclass(errno, errval)</strong></p><p><strong>pymysql.err.InternalError: (1366, “Incorrect string value: ‘\xF0\x9F\x92\x94’ for column ‘content’ at row 1”)</strong></p><p>原因是这条评论有个识别不了的表情，之后百度参考这篇文章<a href="http://blog.csdn.net/HHTNAN/article/details/76769264?locationNum=9&amp;fps=1修改了数据库的编码方式，注意还要自己修改下创建数据库时的编码方式才可！" _src="http://blog.csdn.net/HHTNAN/article/details/76769264?locationNum=9&amp;fps=1修改了数据库的编码方式，注意还要自己修改下创建数据库时的编码方式才可！" target="_blank" rel="noopener">http://blog.csdn.net/HHTNAN/article/details/76769264?locationNum=9&amp;fps=1修改了数据库的编码方式，注意还要自己修改下创建数据库时的编码方式才可！</a></p><p>这是首页数据库效果<img src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802053659.png" title="1802053659.png" alt=""></p><p><br></p><p>获取完成（家驹的歌评论这么少吗？不解）<img src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802055481.png" title="1802055481.png" alt=""></p><p><br></p><section class="editor"><p><img src="https://mmbiz.qlogo.cn/mmbiz/QKDxrVYehicdAibIVUpquF6TQUwXFg6dYCrLBEiasLaVyObib9LjK08qQ7IzkYKROO93uxoEnMSl8zRCWiaY7JwgZWg/0?wx_fmt=jpeg" style="margin: 0px; padding: 0px; max-width: 100%;"></p></section><p>终于完成了，虽然辛苦，但是值得，在这个过程中也学会了很多东西，在写这篇文章时参考了两篇文章，一个是知乎首个回答<a href="https://www.zhihu.com/question/36081767/answer/140287795，另一个就是解密过程https://github.com/cosven/cosven.github.io/issues/30" _src="https://www.zhihu.com/question/36081767/answer/140287795，另一个就是解密过程https://github.com/cosven/cosven.github.io/issues/30" target="_blank" rel="noopener">https://www.zhihu.com/question/36081767/answer/140287795，另一个就是解密过程https://github.com/cosven/cosven.github.io/issues/30</a></p><p>大家有什么问题的话欢迎去我的公众号<strong>日常学python</strong>的后台那里问我，我知道的我都一一为你解答，最后，若你也在这篇文章学到了，可以帮我点个赞，转发下吗？谢谢支持哈！</p><p><br></p><p>ps:若需要完整代码可以在我的公众号<strong>日常学python</strong>后台回复评论即可获取，还有其他福利以后会一一分析</p><p><span style="line-height: inherit;"></span><span style="line-height: inherit;">我的公众号的二维码<img src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802053253.png" title="1802053253.png" _src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802053253.png" alt=""></span></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p></section>
        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="http://sergiojune.com/2018/08/07/python3.x爬取网易云音乐评论/" data-id="cjkizgivh000edcunh1aam3zj" class="article-share-link"><i class="fas fa-share"></i>分享到</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fab fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fab fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fab fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fab fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    

        </footer>
    </div>
    
        
<nav id="article-nav">
    
    
        <a href="/2018/08/07/hexo搭建的博客提交文章本地预览成功但github没有显示解决方法/" id="article-nav-older" class="article-nav-link-wrap">
            <strong class="article-nav-caption">下一篇</strong>
            <div class="article-nav-title">hexo搭建的博客提交文章本地预览成功但github没有显示解决方法</div>
        </a>
    
</nav>


    
</article>


    
    

</section>
            
                
<aside id="sidebar">
   
        
    <div class="widget-wrap">
        <h3 class="widget-title">最新文章</h3>
        <div class="widget">
            <ul id="recent-post" class="">
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2018/08/07/python3.x爬取网易云音乐评论/" class="thumbnail">
    
    
        <span class="thumbnail-image thumbnail-none"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/python/">python</a></p>
                            <p class="item-title"><a href="/2018/08/07/python3.x爬取网易云音乐评论/" class="title">利用python爬取网易云音乐评论，并把数据存入mysql</a></p>
                            <p class="item-date"><time datetime="2018-08-07T00:43:42.113Z" itemprop="datePublished">2018-08-07</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2018/08/07/hexo搭建的博客提交文章本地预览成功但github没有显示解决方法/" class="thumbnail">
    
    
        <span class="thumbnail-image thumbnail-none"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/blog/">blog</a></p>
                            <p class="item-title"><a href="/2018/08/07/hexo搭建的博客提交文章本地预览成功但github没有显示解决方法/" class="title">hexo搭建的博客提交文章本地预览成功但github没有显示解决方法</a></p>
                            <p class="item-date"><time datetime="2018-08-07T00:43:42.059Z" itemprop="datePublished">2018-08-07</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2018/08/07/学习用python操作mysql/" class="thumbnail">
    
    
        <span class="thumbnail-image thumbnail-none"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/python/">python</a><i class="fas fa-angle-right"></i><a class="article-category-link" href="/categories/python/数据库/">数据库</a></p>
                            <p class="item-title"><a href="/2018/08/07/学习用python操作mysql/" class="title">学习用python操作mysql</a></p>
                            <p class="item-date"><time datetime="2018-08-07T00:43:42.012Z" itemprop="datePublished">2018-08-07</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2018/08/07/我爬取了37000条球迷评论，知道了这场比赛的重要信息/" class="thumbnail">
    
    
        <span class="thumbnail-image thumbnail-none"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/python/">python</a></p>
                            <p class="item-title"><a href="/2018/08/07/我爬取了37000条球迷评论，知道了这场比赛的重要信息/" class="title">我爬取了37000条球迷评论，知道了这场比赛的重要信息</a></p>
                            <p class="item-date"><time datetime="2018-08-07T00:43:41.976Z" itemprop="datePublished">2018-08-07</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2018/08/07/谈谈如何抓取ajax动态网站/" class="thumbnail">
    
    
        <span class="thumbnail-image thumbnail-none"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/python/">python</a></p>
                            <p class="item-title"><a href="/2018/08/07/谈谈如何抓取ajax动态网站/" class="title">谈谈如何抓取ajax动态网站</a></p>
                            <p class="item-date"><time datetime="2018-08-07T00:43:41.950Z" itemprop="datePublished">2018-08-07</time></p>
                        </div>
                    </li>
                
            </ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">分类</h3>
        <div class="widget">
            <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/android/">android</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/blog/">blog</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a><span class="category-list-count">17</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/python/数据库/">数据库</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/个人随想/">个人随想</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/前端/">前端</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/总结/">总结</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/数据库/">数据库</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/随想/">随想</a><span class="category-list-count">1</span></li></ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">归档</h3>
        <div class="widget">
            <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">八月 2018</a><span class="archive-list-count">19</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">五月 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">三月 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">十二月 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">十一月 2017</a><span class="archive-list-count">4</span></li></ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">标签</h3>
        <div class="widget">
            <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTML/">HTML</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hard/">hard</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mysql/">mysql</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/requests/">requests</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/requestst/">requestst</a><span class="tag-list-count">11</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/run/">run</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/urllib/">urllib</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/坑/">坑</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/正则表达式/">正则表达式</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/爬虫/">爬虫</a><span class="tag-list-count">16</span></li></ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">标签云</h3>
        <div class="widget tagcloud">
            <a href="/tags/HTML/" style="font-size: 15px;">HTML</a> <a href="/tags/hard/" style="font-size: 10px;">hard</a> <a href="/tags/mysql/" style="font-size: 15px;">mysql</a> <a href="/tags/requests/" style="font-size: 12.5px;">requests</a> <a href="/tags/requestst/" style="font-size: 17.5px;">requestst</a> <a href="/tags/run/" style="font-size: 10px;">run</a> <a href="/tags/urllib/" style="font-size: 10px;">urllib</a> <a href="/tags/坑/" style="font-size: 10px;">坑</a> <a href="/tags/正则表达式/" style="font-size: 15px;">正则表达式</a> <a href="/tags/爬虫/" style="font-size: 20px;">爬虫</a>
        </div>
    </div>

    
        
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">链接</h3>
        <div class="widget">
            <ul>
                
                    <li>
                        <a href="http://hexo.io">Hexo</a>
                    </li>
                
            </ul>
        </div>
    </div>


    
    <div id="toTop" class="fas fa-angle-up"></div>
</aside>

            
        </div>
        <footer id="footer">
    <div class="outer">
        <div id="footer-info" class="inner">
            &copy; 2018 sergiojune<br>
            Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>. Theme by <a href="http://github.com/ppoffice">PPOffice</a>
        </div>
    </div>
</footer>
        


    
        <script src="/libs/lightgallery/js/lightgallery.min.js"></script>
        <script src="/libs/lightgallery/js/lg-thumbnail.min.js"></script>
        <script src="/libs/lightgallery/js/lg-pager.min.js"></script>
        <script src="/libs/lightgallery/js/lg-autoplay.min.js"></script>
        <script src="/libs/lightgallery/js/lg-fullscreen.min.js"></script>
        <script src="/libs/lightgallery/js/lg-zoom.min.js"></script>
        <script src="/libs/lightgallery/js/lg-hash.min.js"></script>
        <script src="/libs/lightgallery/js/lg-share.min.js"></script>
        <script src="/libs/lightgallery/js/lg-video.min.js"></script>
    
    
        <script src="/libs/justified-gallery/jquery.justifiedGallery.min.js"></script>
    
    



<!-- Custom Scripts -->
<script src="/js/main.js"></script>

    </div>
</body>
</html>