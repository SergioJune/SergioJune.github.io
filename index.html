<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="python,sergiojune,记录，算法"><title>sergiojune | 梦开始的地方 | 路在，人就在</title><link rel="stylesheet" type="text/css" href="//fonts.neworld.org/css?family=Source+Code+Pro"><link rel="stylesheet" type="text/css" href="/css/style.css?v=2.0.1"><link rel="stylesheet" type="text/css" href="/css/highlight.css?v=2.0.1"><link rel="Shortcut Icon" href="/favicon.ico"><link rel="bookmark" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">sergiojune | 梦开始的地方</h1><a id="logo" href="/.">sergiojune | 梦开始的地方</a><p class="description">路在，人就在</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div><div id="search-form"><div id="result-mask" class="hide"></div><label><input id="search-key" type="text" autocomplete="off" placeholder="Arama"></label><div id="result-wrap" class="hide"><div id="search-result"></div></div><div class="hide"><template id="search-tpl"><div class="item"><a href="/{path}" title="{title}"><div class="title">{title}</div><div class="time">{date}</div><div class="tags">{tags}</div></a></div></template></div></div></div><div id="layout" class="layout-g"><div class="layout-l"><div class="content_container"><div class="post"><h2 class="post-title"><a href="/2019/01/14/学习用python操作mysql/">学习用python操作mysql</a></h2><div class="post-meta"><p><span class="date">2019-01-14</span><span><a href="/categories/python/" class="category">python</a><a href="/categories/python/数据库/" class="category">数据库</a></span></p></div><div class="post-content">还没有学习如何用python来操作数据库，那我今天就带大家来学习如何用python操操作数据库。</div><p class="readmore"><a href="/2019/01/14/学习用python操作mysql/">阅读更多</a></p></div><div class="post"><h2 class="post-title"><a href="/2019/01/14/谈谈如何抓取ajax动态网站/">谈谈如何抓取ajax动态网站</a></h2><div class="post-meta"><p><span class="date">2019-01-14</span><span><a href="/categories/python/" class="category">python</a></span></p></div><div class="post-content">什么是ajax呢，简单来说，就是加载一个网页完毕之后，有些信息你你还是看不到，需要你点击某个按钮才能看到数据，或者有些网页是有很多页数据的，而你在点击下一页的时候，网页的url地址没有变化，但是内容变了，这些都可以说是ajax。</div><p class="readmore"><a href="/2019/01/14/谈谈如何抓取ajax动态网站/">阅读更多</a></p></div><div class="post"><h2 class="post-title"><a href="/2019/01/14/我爬取了37000条球迷评论，知道了这场比赛的重要信息/">我爬取了37000条球迷评论，知道了这场比赛的重要信息</a></h2><div class="post-meta"><p><span class="date">2019-01-14</span><span><a href="/categories/python/" class="category">python</a></span></p></div><div class="post-content">这两天看恰好有nba决赛，是球迷的你肯定不会错过的，更何况今年的西部决赛是火箭对战勇士，今年的火箭是很强的，因为没到关键时候总会有人站出来。当然，勇士也是挺强的，毕竟不能小看库里杜兰特等四大巨头。</div><p class="readmore"><a href="/2019/01/14/我爬取了37000条球迷评论，知道了这场比赛的重要信息/">阅读更多</a></p></div><div class="post"><h2 class="post-title"><a href="/2019/01/14/老司机带你用python来爬取妹子图/">老司机带你用python来爬取妹子图</a></h2><div class="post-meta"><p><span class="date">2019-01-14</span><span><a href="/categories/python/" class="category">python</a></span></p></div><div class="post-content"><p><section class="_editor" data-mpa-powered-by="yiban.io" style="max-width: 100%; color: rgb(0, 0, 0); font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif; font-size: medium; white-space: normal; word-break: normal !important;"><p class="_brush" style="margin-right: auto; margin-left: auto; max-width: 600px; word-wrap: normal; border-width: 1px; border-style: solid; border-color: rgb(95, 170, 255); font-family: 微软雅黑; font-size: 12px; border-radius: 2em; text-align: center; word-break: normal !important;"><span style="color: rgb(255, 0, 0); word-break: normal !important;">这是日常学python的第14篇原创文章</span></p></section></p><p style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif; font-size: medium; white-space: normal; word-break: normal !important;">我前几篇文章都是说一些python爬虫库的用法，还没有说怎样利用好这些知识玩一些好玩的东西。那我今天带大家玩好玩又刺激的，嘻嘻！对了，requests库和正则表达式很重要的，一定要学会！一定要学会！！一定要学会！！！我现在的爬虫基本都是用这两样东西来爬的。所以学不学你看着办吧。</p><p style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif; font-size: medium; white-space: normal; word-break: normal !important;"><br></p><p style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif; font-size: medium; white-space: normal; word-break: normal !important;">来到今天的重点，我今天发现一个网站很好爬的，非常适合新手，我没有设置请求头什么的爬了很多遍很没有封我ip和给我返回403之类的，所以他对我们第一次玩爬虫的人来说很友好。这个网站就是<strong style="word-break: normal !important;">今日头条</strong>。最重要的是这里面有很多美女图片，我们可以把它们爬下来！！！是不是想想都要流鼻血啊？</p><p style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif; font-size: medium; white-space: normal; word-break: normal !important;"><br></p><p style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif; font-size: medium; white-space: normal; word-break: normal !important;">文章首发于公众号「日常学python」</p><p style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif; font-size: medium; white-space: normal; word-break: normal !important;"><br></p><p style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif; font-size: medium; white-space: normal; word-break: normal !important;">我们今天要爬的就是他的图集，先看看网站。搜索美女，然后点击图集，可以看到下面这些内容<img data-s="300,640" data-type="png" src="https://mmbiz.qlogo.cn/mmbiz_png/BIPpxEvceWichEKjwpicG8pJJ8ghegTVvr1BxvCQiau0ehK8aenHF6ye4vhJEpY1icVyhAl8wl9B4ia5eMY06XiaM3Dw/0?wx_fmt=png" data-ratio="0.628482972136223" data-w="969" style="word-break: normal !important;" _src="https://mmbiz.qlogo.cn/mmbiz_png/BIPpxEvceWichEKjwpicG8pJJ8ghegTVvr1BxvCQiau0ehK8aenHF6ye4vhJEpY1icVyhAl8wl9B4ia5eMY06XiaM3Dw/0?wx_fmt=png"></p><p style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif; font-size: medium; white-space: normal; word-break: normal !important;"><br></p><p style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif; font-size: medium; white-space: normal; word-break: normal !important;">我们要做的就是把上面的图片给爬下来。</p><p style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif; font-size: medium; white-space: normal; word-break: normal !important;"><br></p><p style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif; font-size: medium; white-space: normal; word-break: normal !important;">那开始分析网站。按下f12，然后点击network，刷新下你可以看到这些<img data-s="300,640" data-type="png" src="https://mmbiz.qlogo.cn/mmbiz_png/BIPpxEvceWichEKjwpicG8pJJ8ghegTVvrrQEdXOhlznSLQLll2FKFgDAb9Kxjr86U5G7YIdibrc1jVajdibqGnFNg/0?wx_fmt=png" data-ratio="0.2916666666666667" data-w="1752" style="word-break: normal !important;" _src="https://mmbiz.qlogo.cn/mmbiz_png/BIPpxEvceWichEKjwpicG8pJJ8ghegTVvrrQEdXOhlznSLQLll2FKFgDAb9Kxjr86U5G7YIdibrc1jVajdibqGnFNg/0?wx_fmt=png"></p><p style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif; font-size: medium; white-space: normal; word-break: normal !important;"><br></p><p style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif; font-size: medium; white-space: normal; word-break: normal !important;">进行寻找哪个请求返回这些图片的，在网页上可以看到图片会随着你下拉网页而进行显示更多的图片，这是动态加载的，所以可以轻松知道这个可以在xhr文件中找到，果然，你看<img data-s="300,640" data-type="png" src="https://mmbiz.qlogo.cn/mmbiz_png/BIPpxEvceWichEKjwpicG8pJJ8ghegTVvrm2ndblibZKric4PHFuG6l4McF80iaO8EMg4UScx1M0liaQsNxMPEvCgPfw/0?wx_fmt=png" data-ratio="0.1457725947521866" data-w="686" style="word-break: normal !important;" _src="https://mmbiz.qlogo.cn/mmbiz_png/BIPpxEvceWichEKjwpicG8pJJ8ghegTVvrm2ndblibZKric4PHFuG6l4McF80iaO8EMg4UScx1M0liaQsNxMPEvCgPfw/0?wx_fmt=png"></p><p style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif; font-size: medium; white-space: normal; word-break: normal !important;"><br></p><p style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif; font-size: medium; white-space: normal; word-break: normal !important;">不断往下拉，不断地发送请求，点击这个请求看看是返回什么数据<img data-s="300,640" data-type="png" src="https://mmbiz.qlogo.cn/mmbiz_png/BIPpxEvceWichEKjwpicG8pJJ8ghegTVvrk4uibZTrW2byE363HWSxIbX0yVJWtRicME9DcQwhEPngBicO9BPlicu2Iw/0?wx_fmt=png" data-ratio="0.362874251497006" data-w="835" style="word-break: normal !important;" _src="https://mmbiz.qlogo.cn/mmbiz_png/BIPpxEvceWichEKjwpicG8pJJ8ghegTVvrk4uibZTrW2byE363HWSxIbX0yVJWtRicME9DcQwhEPngBicO9BPlicu2Iw/0?wx_fmt=png"><img data-s="300,640" data-type="png" src="https://mmbiz.qlogo.cn/mmbiz_png/BIPpxEvceWichEKjwpicG8pJJ8ghegTVvr8VkFeVicguqEBEOicGkdrzhsSicx60TRoQlk3ns7mLUfJoH8VNGX4fa9g/0?wx_fmt=png" data-ratio="0.21882640586797067" data-w="818" style="word-break: normal !important;" _src="https://mmbiz.qlogo.cn/mmbiz_png/BIPpxEvceWichEKjwpicG8pJJ8ghegTVvr8VkFeVicguqEBEOicGkdrzhsSicx60TRoQlk3ns7mLUfJoH8VNGX4fa9g/0?wx_fmt=png"></p><p style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif; font-size: medium; white-space: normal; word-break: normal !important;"><br></p><p style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif; font-size: medium; white-space: normal; word-break: normal !important;">可以看到这是个json，里面有图片的url，这个就是我们要找的东西，那我们可以用json库来解析，还有这个网站是get请求，这样就可以用requests库来发送然后解析下就可以了，非常简单。</p><p style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif; font-size: medium; white-space: normal; word-break: normal !important;"><br></p><p style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif; font-size: medium; white-space: normal; word-break: normal !important;">那么分析就到这里，直接上代码</p><section class="output_wrapper" id="output_wrapper_id" style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif; font-size: medium; letter-spacing: 0px; white-space: normal; line-height: 1.6; word-break: normal !important;"><pre style="margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: inherit; color: inherit; line-height: inherit; word-break: normal !important;"><code class="python language-python hljs" style="margin-right: 2px; margin-left: 2px; padding: 0.5em; line-height: 18px; font-size: 14px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; color: rgb(169, 183, 198); background: rgb(40, 43, 46); word-wrap: normal !important; word-break: normal !important; display: block !important; overflow: auto !important;"><span class="hljs-keyword" style="font-size: inherit; line-height: inherit; color: rgb(248, 35, 117); word-wrap: inherit !important; word-break: inherit !important;">import</span> requests, os<br style="word-break: normal !important;">path_a = os.path.abspath(<span class="hljs-string" style="font-size: inherit; line-height: inherit; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">‘.’</span>)<br style="word-break: normal !important;">kw = <span class="hljs-string" style="font-size: inherit; line-height: inherit; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">‘’</span><br style="word-break: normal !important;"><span class="hljs-keyword" style="font-size: inherit; line-height: inherit; color: rgb(248, 35, 117); word-wrap: inherit !important; word-break: inherit !important;">while</span> <span class="hljs-keyword" style="font-size: inherit; line-height: inherit; color: rgb(248, 35, 117); word-wrap: inherit !important; word-break: inherit !important;">True</span>:<br style="word-break: normal !important;"> &nbsp; &nbsp;kw = input(<span class="hljs-string" style="font-size: inherit; line-height: inherit; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">‘请输入你要获取的图片(若想结束请输入1)’</span>)<br style="word-break: normal !important;"> &nbsp; &nbsp;<span class="hljs-keyword" style="font-size: inherit; line-height: inherit; color: rgb(248, 35, 117); word-wrap: inherit !important; word-break: inherit !important;">if</span> kw == <span class="hljs-string" style="font-size: inherit; line-height: inherit; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">‘1’</span>:<br style="word-break: normal !important;"> &nbsp; &nbsp; &nbsp; &nbsp;print(<span class="hljs-string" style="font-size: inherit; line-height: inherit; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">‘已退出，你下载的图片已保存在’</span>+path_a+<span class="hljs-string" style="font-size: inherit; line-height: inherit; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">‘,请查看！’</span>)<br style="word-break: normal !important;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-keyword" style="font-size: inherit; line-height: inherit; color: rgb(248, 35, 117); word-wrap: inherit !important; word-break: inherit !important;">break</span><br style="word-break: normal !important;"> &nbsp; &nbsp;<span class="hljs-keyword" style="font-size: inherit; line-height: inherit; color: rgb(248, 35, 117); word-wrap: inherit !important; word-break: inherit !important;">for</span> x <span class="hljs-keyword" style="font-size: inherit; line-height: inherit; color: rgb(248, 35, 117); word-wrap: inherit !important; word-break: inherit !important;">in</span> range(<span class="hljs-number" style="font-size: inherit; line-height: inherit; color: rgb(174, 135, 250); word-wrap: inherit !important; word-break: inherit !important;">0</span>, <span class="hljs-number" style="font-size: inherit; line-height: inherit; color: rgb(174, 135, 250); word-wrap: inherit !important; word-break: inherit !important;">1000</span>, <span class="hljs-number" style="font-size: inherit; line-height: inherit; color: rgb(174, 135, 250); word-wrap: inherit !important; word-break: inherit !important;">20</span>):<br style="word-break: normal !important;"> &nbsp; &nbsp; &nbsp; &nbsp;url = <span class="hljs-string" style="font-size: inherit; line-height: inherit; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">‘<a href="https://www.toutiao.com/search_content/?offset=&#39;" target="_blank" rel="noopener">https://www.toutiao.com/search_content/?offset=&#39;</a></span>+str(x)+<span class="hljs-string" style="font-size: inherit; line-height: inherit; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">‘&amp;format=json&amp;keyword=%s&amp;autoload=true&amp;count=20&amp;cur_tab=3&amp;from=gallery’</span> % kw<br style="word-break: normal !important;"> &nbsp; &nbsp; &nbsp; &nbsp;response = requests.get(url)<br style="word-break: normal !important;"> &nbsp; &nbsp; &nbsp; &nbsp;data = response.json()[<span class="hljs-string" style="font-size: inherit; line-height: inherit; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">‘data’</span>]<br style="word-break: normal !important;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-keyword" style="font-size: inherit; line-height: inherit; color: rgb(248, 35, 117); word-wrap: inherit !important; word-break: inherit !important;">if</span> <span class="hljs-keyword" style="font-size: inherit; line-height: inherit; color: rgb(248, 35, 117); word-wrap: inherit !important; word-break: inherit !important;">not</span> data:<br style="word-break: normal !important;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;print(<span class="hljs-string" style="font-size: inherit; line-height: inherit; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">‘下载’</span>+kw+<span class="hljs-string" style="font-size: inherit; line-height: inherit; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">‘图片完毕，请换个关键词继续’</span>)<br style="word-break: normal !important;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-keyword" style="font-size: inherit; line-height: inherit; color: rgb(248, 35, 117); word-wrap: inherit !important; word-break: inherit !important;">break</span><br style="word-break: normal !important;"> &nbsp; &nbsp; &nbsp; &nbsp;n = <span class="hljs-number" style="font-size: inherit; line-height: inherit; color: rgb(174, 135, 250); word-wrap: inherit !important; word-break: inherit !important;">1</span> &nbsp;<span class="hljs-comment" style="font-size: inherit; line-height: inherit; color: rgb(128, 128, 128); word-wrap: inherit !important; word-break: inherit !important;"># 记录文章数</span><br style="word-break: normal !important;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-keyword" style="font-size: inherit; line-height: inherit; color: rgb(248, 35, 117); word-wrap: inherit !important; word-break: inherit !important;">for</span> atlas <span class="hljs-keyword" style="font-size: inherit; line-height: inherit; color: rgb(248, 35, 117); word-wrap: inherit !important; word-break: inherit !important;">in</span> data:<br style="word-break: normal !important;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-comment" style="font-size: inherit; line-height: inherit; color: rgb(128, 128, 128); word-wrap: inherit !important; word-break: inherit !important;"># 创建目录</span><br style="word-break: normal !important;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;title = atlas[<span class="hljs-string" style="font-size: inherit; line-height: inherit; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">‘title’</span>]<br style="word-break: normal !important;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;print(atlas)<br style="word-break: normal !important;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-keyword" style="font-size: inherit; line-height: inherit; color: rgb(248, 35, 117); word-wrap: inherit !important; word-break: inherit !important;">try</span>:<br style="word-break: normal !important;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-keyword" style="font-size: inherit; line-height: inherit; color: rgb(248, 35, 117); word-wrap: inherit !important; word-break: inherit !important;">if</span> title <span class="hljs-keyword" style="font-size: inherit; line-height: inherit; color: rgb(248, 35, 117); word-wrap: inherit !important; word-break: inherit !important;">not</span> <span class="hljs-keyword" style="font-size: inherit; line-height: inherit; color: rgb(248, 35, 117); word-wrap: inherit !important; word-break: inherit !important;">in</span> os.listdir(<span class="hljs-string" style="font-size: inherit; line-height: inherit; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">‘.’</span>): &nbsp;<span class="hljs-comment" style="font-size: inherit; line-height: inherit; color: rgb(128, 128, 128); word-wrap: inherit !important; word-break: inherit !important;"># 防止文件名已经存在</span><br style="word-break: normal !important;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;os.mkdir(title)<br style="word-break: normal !important;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-keyword" style="font-size: inherit; line-height: inherit; color: rgb(248, 35, 117); word-wrap: inherit !important; word-break: inherit !important;">except</span> OSError <span class="hljs-keyword" style="font-size: inherit; line-height: inherit; color: rgb(248, 35, 117); word-wrap: inherit !important; word-break: inherit !important;">as</span> e:<br style="word-break: normal !important;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;print(<span class="hljs-string" style="font-size: inherit; line-height: inherit; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">‘文件名出错，创建目录失败，重新创建一个随机名字’</span>)<br style="word-break: normal !important;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;title = kw + <span class="hljs-string" style="font-size: inherit; line-height: inherit; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">‘文件名出错’</span>+str(x)<br style="word-break: normal !important;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-keyword" style="font-size: inherit; line-height: inherit; color: rgb(248, 35, 117); word-wrap: inherit !important; word-break: inherit !important;">if</span> title <span class="hljs-keyword" style="font-size: inherit; line-height: inherit; color: rgb(248, 35, 117); word-wrap: inherit !important; word-break: inherit !important;">not</span> <span class="hljs-keyword" style="font-size: inherit; line-height: inherit; color: rgb(248, 35, 117); word-wrap: inherit !important; word-break: inherit !important;">in</span> os.listdir(<span class="hljs-string" style="font-size: inherit; line-height: inherit; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">‘.’</span>):<br style="word-break: normal !important;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;os.mkdir(title)<br style="word-break: normal !important;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;k = <span class="hljs-number" style="font-size: inherit; line-height: inherit; color: rgb(174, 135, 250); word-wrap: inherit !important; word-break: inherit !important;">1</span> &nbsp;<span class="hljs-comment" style="font-size: inherit; line-height: inherit; color: rgb(128, 128, 128); word-wrap: inherit !important; word-break: inherit !important;"># 记录下载的图片数</span><br style="word-break: normal !important;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;path = os.path.join(path_a, title)<br style="word-break: normal !important;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-comment" style="font-size: inherit; line-height: inherit; color: rgb(128, 128, 128); word-wrap: inherit !important; word-break: inherit !important;"># 转进图片目录</span><br style="word-break: normal !important;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;os.chdir(path)<br style="word-break: normal !important;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-keyword" style="font-size: inherit; line-height: inherit; color: rgb(248, 35, 117); word-wrap: inherit !important; word-break: inherit !important;">for</span> image <span class="hljs-keyword" style="font-size: inherit; line-height: inherit; color: rgb(248, 35, 117); word-wrap: inherit !important; word-break: inherit !important;">in</span> atlas[<span class="hljs-string" style="font-size: inherit; line-height: inherit; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">‘image_list’</span>]: &nbsp;<span class="hljs-comment" style="font-size: inherit; line-height: inherit; color: rgb(128, 128, 128); word-wrap: inherit !important; word-break: inherit !important;"># 这个链接获取的图片是小张的，看着不够爽，所以下面替换成大的图片</span><br style="word-break: normal !important;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;image_url = image[<span class="hljs-string" style="font-size: inherit; line-height: inherit; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">‘url’</span>].replace(<span class="hljs-string" style="font-size: inherit; line-height: inherit; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">‘list’</span>, <span class="hljs-string" style="font-size: inherit; line-height: inherit; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">‘large’</span>) &nbsp;<span class="hljs-comment" style="font-size: inherit; line-height: inherit; color: rgb(128, 128, 128); word-wrap: inherit !important; word-break: inherit !important;"># 改个链接获取大的图片</span><br style="word-break: normal !important;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;atlas = requests.get(<span class="hljs-string" style="font-size: inherit; line-height: inherit; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">‘http:’</span>+image_url).content<br style="word-break: normal !important;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-keyword" style="font-size: inherit; line-height: inherit; color: rgb(248, 35, 117); word-wrap: inherit !important; word-break: inherit !important;">with</span> open(str(k)+<span class="hljs-string" style="font-size: inherit; line-height: inherit; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">‘.jpg’</span>, <span class="hljs-string" style="font-size: inherit; line-height: inherit; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">‘wb’</span>) <span class="hljs-keyword" style="font-size: inherit; line-height: inherit; color: rgb(248, 35, 117); word-wrap: inherit !important; word-break: inherit !important;">as</span> f: &nbsp;<span class="hljs-comment" style="font-size: inherit; line-height: inherit; color: rgb(128, 128, 128); word-wrap: inherit !important; word-break: inherit !important;"># 把图片写入文件内</span><br style="word-break: normal !important;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;f.write(atlas)<br style="word-break: normal !important;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;print(<span class="hljs-string" style="font-size: inherit; line-height: inherit; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">‘下载完第%d个文章的%d幅图完成’</span> % (x+n, k))<br style="word-break: normal !important;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;k += <span class="hljs-number" style="font-size: inherit; line-height: inherit; color: rgb(174, 135, 250); word-wrap: inherit !important; word-break: inherit !important;">1</span><br style="word-break: normal !important;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;n += <span class="hljs-number" style="font-size: inherit; line-height: inherit; color: rgb(174, 135, 250); word-wrap: inherit !important; word-break: inherit !important;">1</span><br style="word-break: normal !important;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-comment" style="font-size: inherit; line-height: inherit; color: rgb(128, 128, 128); word-wrap: inherit !important; word-break: inherit !important;"># 转出图片目录</span><br style="word-break: normal !important;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;os.chdir(path_a)<br style="word-break: normal !important;"></code></pre></section><p style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif; font-size: medium; white-space: normal; word-break: normal !important;"><br></p><p style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif; font-size: medium; white-space: normal; word-break: normal !important;">这个只用了requests库基本就能完成了，os库是用来操作文件目录的，这里就不详细说了。可以看到，代码量非常少，除开注释就大概四十行吧，是不是比其他语言简洁多了？是不是requests库很好用？这里可以充分体现了人生苦短，我用python的真理。</p><p style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif; font-size: medium; white-space: normal; word-break: normal !important;"><br></p><p style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif; font-size: medium; white-space: normal; word-break: normal !important;">而且，他还可换关键字继续搜，你想搜什么照片都可以。</p><p style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif; font-size: medium; white-space: normal; word-break: normal !important;"><br></p><p style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif; font-size: medium; white-space: normal; word-break: normal !important;">下篇文章写个requests库和正则来爬内容的文章，让你们感受下正则的强大！</p><p style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif; font-size: medium; white-space: normal; word-break: normal !important;"><br></p><p style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif; font-size: medium; white-space: normal; word-break: normal !important;">最后给你们看下结果<img data-s="300,640" data-type="png" src="https://mmbiz.qlogo.cn/mmbiz_png/BIPpxEvceWichEKjwpicG8pJJ8ghegTVvrzqhB19fjFC3pbTF4fuumOUpLrha9mX2dTnwqwQlLKCdwpblpy2L7Bg/0?wx_fmt=png" data-ratio="0.6289104638619202" data-w="927" style="word-break: normal !important;" _src="https://mmbiz.qlogo.cn/mmbiz_png/BIPpxEvceWichEKjwpicG8pJJ8ghegTVvrzqhB19fjFC3pbTF4fuumOUpLrha9mX2dTnwqwQlLKCdwpblpy2L7Bg/0?wx_fmt=png"></p><p style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif; font-size: medium; white-space: normal; word-break: normal !important;"><br></p><p style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif; font-size: medium; white-space: normal; word-break: normal !important;">不说那么多了，我要去买营养快线了。</p><p style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif; font-size: medium; white-space: normal; word-break: normal !important;"><br></p><p style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif; font-size: medium; white-space: normal; word-break: normal !important;">上述文章如有错误欢迎在留言区指出，如果这篇文章对你有用，点个赞，转个发如何？</p><p style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif; font-size: medium; white-space: normal; word-break: normal !important;"><br></p><section style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif; font-size: medium; white-space: normal; word-break: normal !important;"><section style="word-break: normal !important;"><section style="padding-right: 8px; padding-left: 8px; height: 35px; display: inline-block; border-top: 1px solid rgb(0, 0, 0); border-right: 1px solid rgb(0, 0, 0); border-bottom: 1px solid rgb(0, 0, 0); font-weight: bold; line-height: 35px; vertical-align: middle; word-break: normal !important; box-sizing: border-box;">MORE</section><section style="padding-right: 8px; padding-left: 8px; height: 35px; display: inline-block; border-top: 1px solid rgb(0, 0, 0); border-bottom: 1px solid rgb(0, 0, 0); line-height: 35px; vertical-align: middle; word-break: normal !important; box-sizing: border-box;">延伸阅读</section><section style="padding-right: 15px; padding-left: 15px; line-height: 2em; word-break: normal !important; box-sizing: border-box;"><p style="word-break: normal !important;"><span style="text-decoration-line: underline; word-break: normal !important;">◐◑<a href="http://mp.weixin.qq.com/s?__biz=MzU0NzY0NzQyNw==&amp;mid=2247483725&amp;idx=1&amp;sn=82eccd84b4f23745427e1c6e963e1b37&amp;chksm=fb4a7be1cc3df2f7ec707f24ff7952b7558ea4cbb79b9bb533a5297977c808327728d3f23106&amp;scene=21#wechat_redirect" target="_blank" _href="http://mp.weixin.qq.com/s?__biz=MzU0NzY0NzQyNw==&amp;mid=2247483725&amp;idx=1&amp;sn=82eccd84b4f23745427e1c6e963e1b37&amp;chksm=fb4a7be1cc3df2f7ec707f24ff7952b7558ea4cbb79b9bb533a5297977c808327728d3f23106&amp;scene=21#wechat_redirect" style="word-break: normal !important;">爬虫必学知识之正则表达式上篇</a><span style="color: rgb(79, 129, 189); word-break: normal !important;"></span></span></p><p style="word-break: normal !important;"><span style="text-decoration-line: underline; word-break: normal !important;">◐◑&nbsp;<a href="http://mp.weixin.qq.com/s?__biz=MzU0NzY0NzQyNw==&amp;mid=2247483720&amp;idx=1&amp;sn=4567a228e1bcca2dcb4c23f0feac39b3&amp;chksm=fb4a7be4cc3df2f234c5b7102f107e72df42a24575dd5d735fb203dddf02ca6e2d3b2b41ce28&amp;scene=21#wechat_redirect" target="_blank" _href="http://mp.weixin.qq.com/s?__biz=MzU0NzY0NzQyNw==&amp;mid=2247483720&amp;idx=1&amp;sn=4567a228e1bcca2dcb4c23f0feac39b3&amp;chksm=fb4a7be4cc3df2f234c5b7102f107e72df42a24575dd5d735fb203dddf02ca6e2d3b2b41ce28&amp;scene=21#wechat_redirect" style="word-break: normal !important;">python爬虫常用库之requests详解</a></span></p><p style="word-break: normal !important;"><span style="text-decoration-line: underline; word-break: normal !important;">◐◑&nbsp;<a href="http://mp.weixin.qq.com/s?__biz=MzU0NzY0NzQyNw==&amp;mid=2247483729&amp;idx=1&amp;sn=3af71892e67f9dd93e8e4dabc98c76b1&amp;chksm=fb4a7bfdcc3df2eb60858642aa905b5b5fccdafd100e9af1099b268e4ccb5b72170e19299423&amp;scene=21#wechat_redirect" target="_blank" style="word-break: normal !important;" _href="http://mp.weixin.qq.com/s?__biz=MzU0NzY0NzQyNw==&amp;mid=2247483729&amp;idx=1&amp;sn=3af71892e67f9dd93e8e4dabc98c76b1&amp;chksm=fb4a7bfdcc3df2eb60858642aa905b5b5fccdafd100e9af1099b268e4ccb5b72170e19299423&amp;scene=21#wechat_redirect">爬虫必学知识之正则表达式下篇</a></span></p><p style="word-break: normal !important;"><br></p><p style="word-break: normal !important;"><br></p></section></section></section><p style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif; font-size: medium; white-space: normal; text-align: center; word-break: normal !important;"><img border="0" data-ratio="1.023076923076923" data-type="png" data-w="130" height="auto" title="undefined" _width="111.297px" src="https://mmbiz.qlogo.cn/mmbiz_png/BIPpxEvceWic7kTqqWcYlc513VaLSgic5P9bIBwdybZBf6KpAX6nhqeHkC0cW2KfQgGCiaREUD1uxt6nLhSO2bWsg/640" data-fail="0" style="margin-bottom: 1.4px; border-radius: 5px; border-width: 1px; border-style: dashed; border-color: rgb(168, 164, 171); box-shadow: rgba(0, 0, 0, 0.33) 6px 6px 5px 0px; word-break: normal !important; visibility: visible !important; width: 111.297px !important;" _src="https://mmbiz.qlogo.cn/mmbiz_png/BIPpxEvceWic7kTqqWcYlc513VaLSgic5P9bIBwdybZBf6KpAX6nhqeHkC0cW2KfQgGCiaREUD1uxt6nLhSO2bWsg/640"><br style="word-break: normal !important;"></p><p style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif; font-size: medium; white-space: normal; text-align: center; word-break: normal !important;"><br></p><p style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif; font-size: medium; white-space: normal; text-align: center; word-break: normal !important;"><span style="font-size: 14px; word-break: normal !important;">日常学python</span></p><p style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif; font-size: medium; white-space: normal; text-align: center; word-break: normal !important;"><span style="font-size: 14px; word-break: normal !important;">代码不止bug，还有美和乐趣</span></p><p><br></p><p></p></div><p class="readmore"><a href="/2019/01/14/老司机带你用python来爬取妹子图/">阅读更多</a></p></div><div class="post"><h2 class="post-title"><a href="/2019/01/14/教你用python登陆豆瓣并爬取影评/">教你用python登陆豆瓣并爬取影评</a></h2><div class="post-meta"><p><span class="date">2019-01-14</span><span><a href="/categories/python/" class="category">python</a></span></p></div><div class="post-content"><section class="96edit" label="Powered by bj.96weixin.com" style="font-size:16px;"><section class="editor"><section editor="bj.96weixin.com" style="margin:0 auto;padding:0;box-sizing:border-box"><section class="yead_bgc wx-bg" style="border-style: solid; -webkit-border-image: url(&quot;https://mmbiz.qpic.cn/mmbiz_png/v4vz52CcB13JzTTXXg3mC439fK28gxRK85c5jJicI6ia4ibEOx5DTicoiciamOZc6hcaLFy9S1AfhJzm8kUAHJnv4jtQ/0&quot;) 15 5 5 fill stretch; color: rgb(51, 51, 51); border-width: 10px 4px 4px; padding: 0px; box-sizing: border-box; background-color: rgb(51, 184, 108);"><section style="width: 100%; font-size: 14px; margin: 0px; line-height: 30px; padding: 0px 5px; box-sizing: border-box;" data-width="100%"><p style="padding:0;margin:0;text-align:justify">在上篇文章爬取豆瓣电影top250后，想想既然爬了电影，干脆就连影评也爬了，这样可以看看人们评价的电影，再加上刚出不久的移动迷官3好像挺热的，干脆就爬他吧，爬完看看好不好看！</p></section></section></section><p><br></p></section><section class="editor"><section style="margin:10px auto;"><section style="width: 100%; font-size: 18px; height: 40px; line-height: 40px; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: rgb(30, 28, 28); text-align: center; box-sizing: border-box;" data-width="100%">进入主题</section><section style="width: 100%; margin-top: 1px; border-top-style: solid; border-top-width: 1px; border-top-color: rgb(30, 28, 28); box-sizing: border-box;" data-width="100%"></section></section></section><p><br></p><p><strong>1.去找目标网页并找到所要找的数据</strong><br></p><p><br></p><p>一进去网页就条件反射打开开发者工具，很容易就看到了这个<img src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802067651.png" title="1802067651.png" _src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802067651.png" alt=""></p><p><br></p><p>鼠标所点的就是我接下来要爬的网站，先看看他的response和请求头之类的信息，他的请求方式时get，response是一个网页结构，这就好办了，我们就可以用正则来匹配出所要的数据，正则还是个很好用的东西，请大家务必要学会啊。那接下来就动手敲代码咯！</p><p><br></p><p>2.<strong>用re+requests获取数据</strong></p><p><br></p><p>获取信息<br></p><p><strong><img src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802067256.png" title="1802067256.png" _src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802067256.png" alt=""></strong></p><p>先把数据写入txt文件中（打开的文件要指定编码为utf-8，要不会出现编码问题，因为window的默认编码方式是gbk，而你的编码为utf-8）<br></p><p><img src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802062970.png" title="1802062970.png" _src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802062970.png" alt=""></p><p>正则表达式和网址<br></p><p><img src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802063224.png" title="1802063224.png" _src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802063224.png" alt=""></p><p><br></p><p>一点击运行，只运行了两页，就出了问题，因为这个评论不止两页</p><p><img src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802061824.png" title="1802061824.png" _src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802061824.png" alt=""></p><p><br></p><p>调试了下，在获取完第二页的时候他返回了个不存在的网页，导致我的正则表达式捕捉不到数据，出现了个空的page，所以就只下载了两页，这应该是被反爬了，继续回网页看看需要加什么请求头，然而我把全部的请求头的信息都加了，还是没用，这就触及到我的盲区了（尴尬脸），但是我可以百度啊，百度一看，看见有人说模拟登陆就可以了，那好，我就来模拟登陆一波！！！</p><p><br></p><p><strong>3.模拟登陆豆瓣</strong></p><p><br></p><p>首先需要看看登陆需要什么参数，这个参数是在豆瓣的登陆网址，先打开登陆，打开开发者工具(要不会看不到后面这个所需要的网页)，填好信息点击登陆，然后点击这个login网页，往下拉就会看到From Data 这个框，这个就是登陆所要的参数<img src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802069594.png" title="1802069594.png" _src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802069594.png" alt=""></p><p><br></p><p>直接把他们复制过来即可</p><p><img src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802067548.png" title="1802067548.png" _src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802067548.png" alt=""></p><p><br></p><p>然后就用post把信息发到服务器完成登陆，但是这有个问题，怎么保存登陆信息呢？这就需要用到<strong>Session()</strong>来保留了，但是注意，只需要建立一个会话信息就可以了，不是每个都用这个方法，我初学时就是犯这个错误以至于我搞了很久还没有登陆成功。代码如下</p><p><img src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802066457.png" title="1802066457.png" _src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802066457.png" alt=""></p><p>然后用这个post上去，注意！注意！注意！post的网址是登陆网址，不是你要爬的网址，我刚学时也是被这个坑了很久(怎么感觉我很多问题)，还有其他用requests的都需要替换成<strong>self.ssession()</strong></p><p><img src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802067203.png" title="1802067203.png" _src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802067203.png" alt=""></p><p>​</p><p>最后这样<br></p><p><img src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802068961.png" title="1802068961.png" _src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802068961.png" alt=""></p><p><img src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802066811.png" title="1802066811.png" _src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802066811.png" alt=""></p><p>大功告成，由于只能获取500条这是因为豆瓣只开放了500条评论信息，多一条都不肯给</p><p><br></p><p><strong>4.登陆多了需要填验证码</strong></p><p><br></p><p>由于我多次登陆注销，然后我就需要填验证码了，然而这还是难不到我，还是分析网页找出验证码图片然后下载下来自己填写，还没有那些大佬那么厉害可以用人工智能来填写，代码如下<img src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802064517.png" title="1802064517.png" _src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802064517.png" alt=""></p><p><br></p><p>还有将数据保留到数据库，我就不贴了，代码和上篇文章的差不多</p><p><br></p><section class="editor"><p><img src="https://mmbiz.qlogo.cn/mmbiz/QKDxrVYehicdAibIVUpquF6TQUwXFg6dYCrLBEiasLaVyObib9LjK08qQ7IzkYKROO93uxoEnMSl8zRCWiaY7JwgZWg/0?wx_fmt=jpeg" style="margin: 0px; padding: 0px; max-width: 100%;"></p></section><p>通过这个我学会了使用session来保存会话信息来登陆简单网页，还可以填写验证码，自己还是觉得有点高大上的，嘻嘻。由于本人还没学数据分析，就只能到这里，而生成词云也有点不会，直接复制粘贴来无趣，所以就先不写了，等大神你来写吧！</p><p><br></p><p>最后非常感谢你看完了我的文章，如果觉得有用可以点赞，转发哈！若需要完整代码在微信公众号<strong>日常学python</strong>后台回复<strong>影评</strong>即可，若需要python相关的电子书也可以回复<strong>pdf</strong>获得，日后还会有更多福利发给你</p><p><br></p><p><br></p><p style="text-align: center;"><span style="font-size: 14px;">日常学python</span></p><p><br></p><p style="text-align: center;"><img style="border-radius: 5px; border: 1px dashed rgb(168, 164, 171); box-shadow: rgba(0, 0, 0, 0.329412) 6px 6px 5px 0px; margin-bottom: 1.4px; visibility: visible !important; width: 111.297px !important;" src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802054148.png" height="auto" border="0" alt="1802054148.png" _src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802054148.png"></p><p style="text-align: center;"><span style="font-size: 14px;">一个专注于python的公众号</span></p><p><br></p><p><br></p><p><br></p></section></div><p class="readmore"><a href="/2019/01/14/教你用python登陆豆瓣并爬取影评/">阅读更多</a></p></div><div class="post"><h2 class="post-title"><a href="/2019/01/14/反爬虫与反反爬虫/">反爬虫与反反爬虫</a></h2><div class="post-meta"><p><span class="date">2019-01-14</span><span><a href="/categories/python/" class="category">python</a></span></p></div><div class="post-content"><section class="96edit" label="Powered by bj.96weixin.com" style="font-size:16px;"><section class="editor"><section editor="bj.96weixin.com" style="margin:0 auto;padding:0;box-sizing:border-box"><section class="yead_bgc wx-bg" style="border-style: solid; -webkit-border-image: url(&quot;https://mmbiz.qpic.cn/mmbiz_png/v4vz52CcB13JzTTXXg3mC439fK28gxRK85c5jJicI6ia4ibEOx5DTicoiciamOZc6hcaLFy9S1AfhJzm8kUAHJnv4jtQ/0&quot;) 15 5 5 fill stretch; color: rgb(51, 51, 51); border-width: 10px 4px 4px; padding: 0px; box-sizing: border-box; background-color: rgb(51, 184, 108);"><section style="width: 100%; font-size: 14px; margin: 0px; line-height: 30px; padding: 0px 5px; box-sizing: border-box;" data-width="100%"><p style="padding:0;margin:0;text-align:justify">喜欢爬虫的伙伴都知道，在爬网站的内容的时候并不是一爬就可以了，有时候就会遇到一些网站的反爬虫，折回让你爬不到数据，给你返回一些404，403或者500的状态码，这有时候会让人苦不堪言，就如我昨天发的爬网易云音乐评论，在你爬的数据较多时，网站认为你是一个机器，就不让你爬了，网易云就给我返回了一个<strong>{“code”:-460,”msg”:”Cheating”}，</strong>你不看下他的返回内容还不知道自己被反爬虫，不过不用担心，既然网页有反爬虫，可我们也有反反爬虫，今天就给大家说说反爬虫与反反爬虫。</p></section></section></section><p><br></p></section><section class="editor"><section style="border: 0px; margin: 0px auto; padding: 0px; text-align: center; box-sizing: border-box;"><section style="padding: 5px 10px; line-height: 30px; text-align: center; font-size: 14px; border: 3px solid rgb(51, 184, 108); display: inline-block; box-sizing: border-box; background-color: rgb(255, 255, 255);"><section style="padding: 0px; color: rgb(255, 255, 255); height: 30px; width: 30px; line-height: 30px; text-align: center; font-size: 14px; display: inline-block; border-radius: 100%; box-sizing: border-box; background-color: rgb(51, 184, 108);"><p>1</p></section><section style="padding: 0px 0px 0px 10px; color: rgb(51, 184, 108); line-height: 30px; text-align: center; font-size: 14px; border: 0px; display: inline-block; box-sizing: border-box;"><p>网页的反爬虫</p></section></section><section style="padding: 0px; margin: 0px auto; color: rgb(255, 255, 255); width: 0px; height: 0.4rem; text-align: center; border-width: 0.4rem 0.6rem 0px; border-style: solid; border-color: rgb(51, 184, 108) rgb(255, 255, 255) rgb(255, 255, 255); box-sizing: border-box;"></section></section></section><p><br></p><p><strong>1.通过网页的请求头</strong><br></p><p>首先我们先看看网易云音乐评论的请求头<img src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802099052.png" title="1802099052.png" alt=""><strong><br></strong></p><p><br></p><p><strong>User-Agent：</strong>这个是保存用户访问该网站的浏览器的信息，我上面这个表示的是我通过window的浏览器来访问这个网站的，如果你是用python来直接请求这个网站的时候，这个的信息会带有python的字眼，所以网站管理员可以通过这个来进行反爬虫。</p><p><br></p><p><strong>Referer：</strong>当浏览器发送请求时，一般都会带上这个，这个可以让网站管理者知道我是通过哪个链接访问到这个网站的，上面就说明我是从网易云音乐的主页来访问到这个页面的，若你是用python来直接请求是，就没有访问来源，那么管理者就轻而易举地判断你是机器在操作。</p><p><br></p><p><strong><span style="color: rgb(63, 63, 63); font-family: 'microsoft yahei'; line-height: 27.2px;">authorization</span></strong>:有的网站还会有这个请求头，这个是在用户在访问该网站的时候就会分配一个id给用户，然后在后台验证该id有没有访问权限从而来进行发爬虫。<br></p><p><br></p><p><strong>2.用户访问网站的ip</strong></p><p>当你这个ip在不断地访问一个网站来获取数据时，网页后台也会判断你是一个机器。就比如我昨天爬的网易云音乐评论，我刚开始爬的一首《海阔天空》时，因为评论较少，所以我容易就得到所有数据，但是当我选择爬一首较多评论的《等你下课》时，在我爬到800多页的时候我就爬不了，这是因为你这个ip的用户在不断地访问这个网站，他已经把你视为机器，所以就爬不了，暂时把你的ip给封了。<strong><br></strong></p><p><br></p><section class="editor"><section style="border: 0px; margin: 0px auto; padding: 0px; text-align: center; box-sizing: border-box;"><section style="padding: 5px 10px; line-height: 30px; text-align: center; font-size: 14px; border: 3px solid rgb(51, 184, 108); display: inline-block; box-sizing: border-box; background-color: rgb(255, 255, 255);"><section style="padding: 0px; color: rgb(255, 255, 255); height: 30px; width: 30px; line-height: 30px; text-align: center; font-size: 14px; display: inline-block; border-radius: 100%; box-sizing: border-box; background-color: rgb(51, 184, 108);"><p>2</p></section><section style="padding: 0px 0px 0px 10px; color: rgb(51, 184, 108); line-height: 30px; text-align: center; font-size: 14px; border: 0px; display: inline-block; box-sizing: border-box;"><p>我们的反反爬虫</p></section></section><section style="padding: 0px; margin: 0px auto; color: rgb(255, 255, 255); width: 0px; height: 0.4rem; text-align: center; border-width: 0.4rem 0.6rem 0px; border-style: solid; border-color: rgb(51, 184, 108) rgb(255, 255, 255) rgb(255, 255, 255); box-sizing: border-box;"></section></section></section><p><br></p><p><strong>1.添加请求头</strong></p><p>既然在请求网页的时候需要请求头，那么我们只需要在post或者get的时候把我们的请求头加上就可以了，怎样加？可以使用<strong>requests</strong>库来添加，在post，get或者其他方法是加上<strong>headers</strong>参数就可以了，而请求头不需要复制所有的信息，只需要上面的三个之中一个就可以，至于哪个自己判断，或者直接添加所有也可以，这样我们就可以继续爬了。</p><p><br></p><p><strong>2.使用代理ip</strong></p><p>若是网站把你的ip给封了，你添加什么的请求头也都没有用了，那我们就只有等他解封我们才可以继续爬吗？我可以十分自信告诉你：<strong>不需要</strong>，我们可以使用代理ip来继续爬，我们可以爬取网络上的免费ip来爬，至于免费的代理ip质量怎样你们应该知道，有必要可以买些不免费的，这样好点，我们平时的练习用免费的代理ip就可以了，可以自己爬取一些免费代理ip建成ip池，然后爬的时候就把ip随机取出来，我偷偷告诉你：小编明天的文章就是教你怎样搭建自己的代理ip池。</p><p><br></p><section class="editor"><section style="border: 0px none; box-sizing: border-box;"><section style="margin: 10px 0px; padding: 0px; text-align: center; font-family: 微软雅黑; box-sizing: border-box;"><section class="96wx-bdlc 96wx-bdrc" style="margin: 0px; padding: 0px; height: 24px; border-right-width: 1px; border-right-style: solid; border-right-color: rgb(245, 189, 209); border-left-width: 1px; border-left-style: solid; border-left-color: rgb(245, 189, 209); box-sizing: border-box;"></section><section class="96wx-bdbc" style="margin-top: -12px; margin-bottom: -12px; padding: 0px; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(245, 189, 209); box-sizing: border-box;"></section><section style="margin: 0px; padding: 0px; display: inline-block; box-sizing: border-box;"><section class="96wx-bdrc" style="margin: 0px; padding: 0px; border-right-width: 15px; border-right-style: solid; border-right-color: rgb(245, 189, 209); border-top-width: 12px; border-top-style: solid; border-top-color: transparent; border-bottom-width: 12px; border-bottom-style: solid; border-bottom-color: transparent; height: 0px; width: 0px; float: left; box-sizing: border-box;"></section><section class="96wx-bgc" style="margin: 0px; padding: 0px; height: 24px; min-width: 4em; color: rgb(255, 255, 255); line-height: 24px; float: left; box-sizing: border-box; background-color: rgb(245, 189, 209);"><span style="color:inherit; font-size:12px">END</span></section><section class="96wx-bdlc" style="margin: 0px; padding: 0px; border-left-width: 15px; border-left-style: solid; border-left-color: rgb(245, 189, 209); border-top-width: 12px; border-top-style: solid; border-top-color: transparent; height: 0px; width: 0px; float: left; border-bottom-width: 12px; border-bottom-style: solid; border-bottom-color: transparent; box-sizing: border-box;"></section></section></section></section></section><p>结束语：上面的只是个人在爬一些网站时候遇到的一些反爬虫，这只是很简单的，还有那些动态网站的反爬虫自己还没有接触，等到以后接触了，再一 一补充。最后给大家在爬虫上的建议，就是爬取速度不要太快，最好每几个就隔几秒，不要给服务器造成太大的压力，也可以在爬虫的时候选择一些访问量少点的时间段，这是对服务器好，也是对你自己好！</p><section class="editor"><p><br></p></section><p style="text-align: center;"><span style="font-size: 14px;">日常学python</span></p><p><br></p><p style="text-align: center;"><img style="border-radius: 5px; border: 1px dashed rgb(168, 164, 171); box-shadow: rgba(0, 0, 0, 0.329412) 6px 6px 5px 0px; margin-bottom: 1.4px; visibility: visible !important; width: 111.297px !important;" src="http://pic.96weixin.com/upload/image2/vip/881679/1802/1802054148.png" height="auto" border="0" alt="1802054148.png"></p><p style="text-align: center;"><span style="font-size: 14px;">一个专注于python的公众号</span></p><p><br></p></section></div><p class="readmore"><a href="/2019/01/14/反爬虫与反反爬虫/">阅读更多</a></p></div><div class="post"><h2 class="post-title"><a href="/2019/01/14/搭建自己的代理ip池/">搭建自己的代理ip池</a></h2><div class="post-meta"><p><span class="date">2019-01-14</span><span><a href="/categories/python/" class="category">python</a></span></p></div><div class="post-content">会搭建一个属于自己的代理ip池</div><p class="readmore"><a href="/2019/01/14/搭建自己的代理ip池/">阅读更多</a></p></div><div class="post"><h2 class="post-title"><a href="/2019/01/14/python爬取豆瓣电影Top250/">利用python爬取豆瓣电影Top250，并把数据放入MySQL数据库</a></h2><div class="post-meta"><p><span class="date">2019-01-14</span><span><a href="/categories/python/" class="category">python</a></span></p></div><div class="post-content">学习了python基础后，一心想着快速入门爬虫，因为我就是为爬虫而学的python,所以就找了这个豆瓣电影来爬取。</div><p class="readmore"><a href="/2019/01/14/python爬取豆瓣电影Top250/">阅读更多</a></p></div><div class="post"><h2 class="post-title"><a href="/2019/01/14/python爬虫常用库之requests详解/">python爬虫常用库之requests详解</a></h2><div class="post-meta"><p><span class="date">2019-01-14</span><span><a href="/categories/python/" class="category">python</a></span></p></div><div class="post-content">创作这个库的原因就是想让python开发者更加容易地发起请求，处理请求。里面还有个名字：<strong>HTTP for Humans</strong>,顾名思义，就是用来请求http的。想看源代码的可以在github上搜索他的名字就可以看到了。</div><p class="readmore"><a href="/2019/01/14/python爬虫常用库之requests详解/">阅读更多</a></p></div><div class="post"><h2 class="post-title"><a href="/2019/01/14/python爬虫常用库之BeautifulSoup详解/">python爬虫常用库之BeautifulSoup详解</a></h2><div class="post-meta"><p><span class="date">2019-01-14</span><span><a href="/categories/python/" class="category">python</a></span></p></div><div class="post-content">经过了前面几篇文章的学习，估计你已经会爬不少中小型网站了。但是有人说，前面的正则很难唉，学不好。正则的确很难，有人说过：如果一个问题用正则解决，那么就变成了两个问题。所以说学不会是很正常的，不怕，除了正则，我们还可以用另外一个强大的库来解析html。所以，今天的主题就是来学习这个强大的库</div><p class="readmore"><a href="/2019/01/14/python爬虫常用库之BeautifulSoup详解/">阅读更多</a></p></div><nav class="page-navigator"><span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/2/">下一页</a></nav></div></div><div class="layout-r"><div id="sidebar"><div class="search-pla"></div><div class="widget"><div class="widget-title"><i class="fa fa-xie"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2019/01/14/学习用python操作mysql/">学习用python操作mysql</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01/14/谈谈如何抓取ajax动态网站/">谈谈如何抓取ajax动态网站</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01/14/我爬取了37000条球迷评论，知道了这场比赛的重要信息/">我爬取了37000条球迷评论，知道了这场比赛的重要信息</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01/14/老司机带你用python来爬取妹子图/">老司机带你用python来爬取妹子图</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01/14/教你用python登陆豆瓣并爬取影评/">教你用python登陆豆瓣并爬取影评</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01/14/反爬虫与反反爬虫/">反爬虫与反反爬虫</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01/14/搭建自己的代理ip池/">搭建自己的代理ip池</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01/14/python爬取豆瓣电影Top250/">利用python爬取豆瓣电影Top250，并把数据放入MySQL数据库</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01/14/python爬虫常用库之requests详解/">python爬虫常用库之requests详解</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01/14/python爬虫常用库之BeautifulSoup详解/">python爬虫常用库之BeautifulSoup详解</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-gui"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Fiddler/">Fiddler</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/blog/">blog</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a><span class="category-list-count">17</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/python/数据库/">数据库</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/个人随想/">个人随想</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/基础/">基础</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/总结/">总结</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/数据库/">数据库</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/数据结构/">数据结构</a><span class="category-list-count">6</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-biao"> 标签</i></div><div class="tagcloud"><a href="/tags/胡思乱想/" style="font-size: 15px;">胡思乱想</a> <a href="/tags/hard/" style="font-size: 15px;">hard</a> <a href="/tags/坑/" style="font-size: 15px;">坑</a> <a href="/tags/栈/" style="font-size: 15px;">栈</a> <a href="/tags/单链表-冒泡排序/" style="font-size: 15px;">单链表 冒泡排序</a> <a href="/tags/单链表/" style="font-size: 15px;">单链表</a> <a href="/tags/数组/" style="font-size: 15px;">数组</a> <a href="/tags/时间复杂度/" style="font-size: 15px;">时间复杂度</a> <a href="/tags/c/" style="font-size: 15px;">c</a> <a href="/tags/爬虫/" style="font-size: 15px;">爬虫</a> <a href="/tags/requestst/" style="font-size: 15px;">requestst</a> <a href="/tags/抓包/" style="font-size: 15px;">抓包</a> <a href="/tags/mysql/" style="font-size: 15px;">mysql</a> <a href="/tags/requests/" style="font-size: 15px;">requests</a> <a href="/tags/正则表达式/" style="font-size: 15px;">正则表达式</a> <a href="/tags/urllib/" style="font-size: 15px;">urllib</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-archive"> 归档</i></div><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">五月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">三月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">十二月 2017</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-you"> 友情链接</i></div><ul></ul><a href="https://sergiojune.com/about/" title="需要设置请联系我" target="_blank">需要设置请联系我</a></div></div></div></div><a id="totop" href="#top"></a><div id="footer"><div class="footer-info"><p><a href="/baidusitemap.xml">Baidu Site Haritası</a> |  <a href="/atom.xml">订阅</a> |  <a href="/about/">关于</a></p><p>本站总访问量：<i id="busuanzi_container_site_pv"><i id="busuanzi_value_site_pv"></i></i>次</p><p><span> Copyright &copy;<a href="/." rel="nofollow">sergiojune.</a></span><span> Theme by<a rel="nofollow" target="_blank" href="https://github.com/chaooo/hexo-theme-BlueLake"> BlueLake.</a></span><span> Count by<a href="http://busuanzi.ibruce.info/"> busuanzi.</a></span><span> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a></span></p></div></div></div><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><script type="text/javascript" src="/js/search.json.js?v=2.0.1"></script><script type="text/javascript" src="/js/totop.js?v=2.0.1" async></script></body></html>